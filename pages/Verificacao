
# pages/Verificacao.py
import streamlit as st
import sqlite3
import os

DB_PATH = "certificados.db"
st.set_page_config(page_title="Verificação de Certificados", page_icon="✅", layout="centered")
st.title("Verificação de Certificados - NICE / Alfa Unipac")

def find_by_code(code: str):
    con = sqlite3.connect(DB_PATH)
    cur = con.cursor()
    cur.execute("SELECT nome,evento,condicao,instituicao,data_evento,carga_horaria,codigo_originalidade,data_emissao FROM certificados WHERE codigo_rastreio=?", (code.strip(),))
    row = cur.fetchone()
    con.close()
    return row

q = st.query_params.get("verificar", [""])
code = q[0] if q else ""
code = st.text_input("Digite o código (######.######)", value=code)

if st.button("Verificar"):
    if not code.strip():
        st.warning("Informe um código.")
    else:
        r = find_by_code(code)
        if not r:
            st.error("❌ Código não encontrado neste banco local.")
        else:
            st.success("✅ Certificado autêntico (base local).")
            campos = ["Nome","Evento","Condição","Instituição","Data do evento","Carga horária","Originalidade","Data de emissão"]
            for k,v in zip(campos, r):
                st.write(f"**{k}:** {v}")
